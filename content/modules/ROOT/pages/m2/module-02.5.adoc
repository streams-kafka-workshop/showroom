:imagesdir: ../../assets/images
include::../style.adoc[]
:check: ✓
:cross: ×

== Real-World Kafka Application in Action: E-Commerce Activity Tracking

In this section, we will explore an e-commerce application to demonstrate real-time data streaming and processing use cases. The Globex web application used in this workshop is a demo app and as such does not pretend to be a real-life retail application, but it packs enough functionality to make it feel like a real retail web app.

* From your browser, navigate to link:{openshift_cluster_console}/topology/ns/*globex-{user_name}*?view=graph[OpenShift Cluster Console, window="_console"]. Login with your username and password (`{user_name}`/`{password}`).


// * You should be redirected to a view which lists the different OpenShift _projects_ (also known as _namespaces_) you have access to.
// +
// image::m2/openshift-console-developer-view-projects.png[]
// +
// [NOTE]
// ====
// The list of namespaces you have access to will depends on which modules you have deployed.
// ====




* The Globex web application is deployed in the *globex-{user_name}* namespace. You should see the  topology view of the namespace. The Topology view gives you a graphical representation of the different resources deployed in the namespace.
+
image::m2/openshift-console-globex-namespace.png[]


* In the *Topology View* , expect to see something like this in the *globex-{user_name}* namespace:
+
image::m2/openshift-console-topology-view.png[]
+
The Globex web-app deployment consists of:
+
[cols="28m,~"]
[frame=all, grid=all]
|===
|*Service* | *Description*

| globex-web
| The web front-end of the Globex web application* Running on Node.js with an Angular UI.

| globex-store-app
| The backend application of the Globex retail app* Written in Quarkus* Provides catalog, inventory, cart and order services* 

| globex-db
| The PostgreSQL database used by the globex-store-app application* Stores the catalog, inventory, customer and order information.

| activity-tracking 
| This microservice has a REST endpoint for user activity events generated from the UI. These events are produced to a Kafka topic.

| recommendation-engine (We will explore this service in more detail in a later module.)
| An example of an application which does real-time processing of an event stream* This application uses Kafka Streams, an event-streaming library, to process the stream of events produced by the activity tracking service to build a list of the most popular products on the web site* This list is exposed as a REST endpoint, and called by the front-end to display featured products.

|===

* To open the Globex web application, click on the image:m2/openshift-console-open-url.png[] symbol next to the *globex-web* deployment in the topology view.
+
image::m2/openshift-console-open-url-2.png[]
+
This opens a new browser tab pointing to the home page of the Globex Web application. Alternatively, open a new browser tab and navigate to link:{globex_web_url}[Globex-Web, window="_globex"].


== Generate user _like_ activity


* On the Globex web site, click on the *Cool Stuff Store* link on the top menu. From here you can browse through the product catalog, open product detail pages and add items to the shopping cart.
+
image::m2/globex-view-catalog.png[]
+
NOTE: The product catalog might take a few seconds to load the first time.

* To generate user activity events, click on the image:m2/globex-product-like.png[] symbol next to a product. You can repeat this for 3-4 products.

* Every _like_ action generates a user activity event that is captured by the _activity tracking_ service and sent to a Kafka topic. 

* The Kafka broker is installed in the *kafka-{user_name}* namespace. In the same namespace, streams for Apache Kafka console, a web UI for viewing Kafka topics and browsing consumer groups, is also installed.

* Click to navigate to link:https://amq-streams-console-{user_name}.{openshift_cluster_subdomain}[streams for Apache Kafka console, window="_amqstreams"]. This redirects you to the streams for Apache Kafka console login page. For the purpose of this workshop, choose *Click to login anonymously* to access the console

* Choose the *Topics* menu on the left-hand side to see the list of topics.
+
image::m2/globex-tracking-topic-console.png[]

* One of those topics is called *globex.tracking*, which is the topic that contains the user activity events. Click on the topic name to see the details of the topic. If you liked some products on the web site, the topic should contain some messages.
+
image::m2/amqstreams-globex-tracking.png[]

* Click on any of the messages listed to see its contents* In this case, the body of each message consists of a JSON structure of a user activity event from the Globex web application.
+
image::m2/amqstreams-expand-message.png[]

* The activity tracking service is the producer of these events. All the events such as likes are sent to the *globex.tracking* topic in real-time using the Kafka Producer API.


This is a simple real world practical example of a Kafka producer application that sends events to a Kafka topic. Both the activity tracking and recommendation engine services(which we will explore in the stream processing module) are implemented using Quarkus, a Java framework for building cloud-native applications,  which simplifies the interaction with Kafka as compared to using the Kafka Producer API directly.

=== Up Next
Let's briefly explore how Quarkus simplifies the interaction with Kafka. 

